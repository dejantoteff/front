{"remainingRequest":"/home/just/repos/front/node_modules/thread-loader/dist/cjs.js??ref--4-1!/home/just/repos/front/node_modules/ts-loader/index.js??ref--4-2!/home/just/repos/front/src/_modules/getUserData.ts","dependencies":[{"path":"/home/just/repos/front/src/_modules/getUserData.ts","mtime":1519579843851},{"path":"/home/just/repos/front/node_modules/cache-loader/dist/cjs.js","mtime":1520676156713},{"path":"/home/just/repos/front/node_modules/thread-loader/dist/cjs.js","mtime":1520676204585},{"path":"/home/just/repos/front/node_modules/ts-loader/index.js","mtime":1520676144729}],"contextDependencies":[],"result":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst rambdax_1 = require(\"rambdax\");\nconst getCredentials_1 = require(\"../user/_helpers/getCredentials\");\nconst userLogin_1 = require(\"./userLogin\");\nfunction getUserData(getPouchDB) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const credentials = getCredentials_1.getCredentials();\n        if (credentials === false) {\n            return { forRootReducer: {} };\n        }\n        const { userDBName, password } = credentials;\n        const { ok, userDBCloud } = yield userLogin_1.userLogin({\n            getPouchDB,\n            password,\n            userDBName,\n        });\n        if (!ok) {\n            return { forRootReducer: {} };\n        }\n        const userDoc = yield userDBCloud.get('data');\n        const picked = rambdax_1.pick('points,randomFlag,textToSpeechFlag', userDoc);\n        const forRootReducer = Object.assign({}, picked, { logged: true, userDBCloud });\n        return {\n            forRootReducer,\n            userDoc,\n        };\n    });\n}\nexports.getUserData = getUserData;\n",{"version":3,"file":"/home/just/repos/front/src/_modules/getUserData.ts","sourceRoot":"","sources":["/home/just/repos/front/src/_modules/getUserData.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,qCAA8B;AAC9B,oEAAgE;AAChE,2CAAuC;AAEvC,qBAAkC,UAAe;;QAC/C,MAAM,WAAW,GAAG,+BAAc,EAAE,CAAA;QAEpC,EAAE,CAAC,CAAC,WAAW,KAAK,KAAK,CAAC,CAAC,CAAC;YAE1B,MAAM,CAAC,EAAE,cAAc,EAAE,EAAE,EAAE,CAAA;QAC/B,CAAC;QAED,MAAM,EAAE,UAAU,EAAE,QAAQ,EAAE,GAAG,WAAW,CAAA;QAC5C,MAAM,EAAE,EAAE,EAAE,WAAW,EAAE,GAAG,MAAM,qBAAS,CAAC;YAC1C,UAAU;YACV,QAAQ;YACR,UAAU;SACX,CAAC,CAAA;QAEF,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YAER,MAAM,CAAC,EAAE,cAAc,EAAE,EAAE,EAAE,CAAA;QAC/B,CAAC;QACD,MAAM,OAAO,GAAG,MAAM,WAAW,CAAC,GAAG,CAAC,MAAM,CAAC,CAAA;QAC7C,MAAM,MAAM,GAAG,cAAI,CAAC,oCAAoC,EAAE,OAAO,CAAC,CAAA;QAElE,MAAM,cAAc,qBACf,MAAM,IACT,MAAM,EAAE,IAAI,EACZ,WAAW,GACZ,CAAA;QAED,MAAM,CAAC;YACL,cAAc;YACd,OAAO;SACR,CAAA;IACH,CAAC;CAAA;AAhCD,kCAgCC","sourcesContent":["import { pick } from 'rambdax'\nimport { getCredentials } from '../user/_helpers/getCredentials'\nimport { userLogin } from './userLogin'\n\nexport async function getUserData(getPouchDB: any) {\n  const credentials = getCredentials()\n\n  if (credentials === false) {\n\n    return { forRootReducer: {} }\n  }\n\n  const { userDBName, password } = credentials\n  const { ok, userDBCloud } = await userLogin({\n    getPouchDB,\n    password,\n    userDBName,\n  })\n\n  if (!ok) {\n\n    return { forRootReducer: {} }\n  }\n  const userDoc = await userDBCloud.get('data')\n  const picked = pick('points,randomFlag,textToSpeechFlag', userDoc)\n\n  const forRootReducer = {\n    ...picked,\n    logged: true,\n    userDBCloud,\n  }\n\n  return {\n    forRootReducer,\n    userDoc,\n  }\n}\n"]}]}